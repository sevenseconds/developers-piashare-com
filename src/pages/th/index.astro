---
import MicroBlogLayout from '../../layouts/MicroBlogLayout.astro';
import Post from '../../components/Post.astro';
import { getCollection } from 'astro:content';

// Get Thai blog posts
const blogPosts = await getCollection('blog', ({ data }) => {
  return data.lang === 'th';
});

// Sort by date (newest first)
const sortedPosts = blogPosts.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<MicroBlogLayout title="PiaShare นักพัฒนา">
	<h1 class="text-3xl sm:text-4xl font-bold mb-8 text-gray-900 dark:text-white">ข่าวสารเทคโนโลยี</h1>
	<div class="space-y-6">
		{sortedPosts.map((post) => (
			<Post
				title={post.data.title}
				subtitle={post.data.subtitle}
				image={post.data.image}
				tags={post.data.tags}
				author={post.data.author}
				date={post.data.date.toLocaleDateString('th-TH', { 
					year: 'numeric', 
					month: 'short', 
					day: 'numeric' 
				})}
				readTime={post.data.readTime}
				href={`/th/posts/${post.id.replace('th/', '')}`}
				showThumbnail={false}
				lang={post.data.lang}
			/>
		))}
	</div>
</MicroBlogLayout>