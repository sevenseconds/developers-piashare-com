---
import { getCollection } from 'astro:content';

// Get recent posts for both languages
const recentPosts = await getCollection('blog');
const sortedRecentPosts = recentPosts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 5);
---

<aside class="fixed right-0 top-0 h-full w-80 bg-white dark:bg-black border-l border-gray-200 dark:border-gray-800 hidden lg:block overflow-y-auto">
  <div class="p-4 pt-6">
    <!-- Recents Section -->
    <div class="mb-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 px-4">Recents</h3>
      <div class="bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-sm">
        <div class="divide-y divide-gray-200 dark:divide-gray-800">
          {sortedRecentPosts.map((post) => (
            <a href={`/posts/${post.id.replace(/^(th|en)\//, '')}`} class="block p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
              <div class="space-y-1">
                <p class="text-sm font-medium text-gray-900 dark:text-white line-clamp-2 leading-tight">
                  {post.data.title}
                </p>
                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400 space-x-1">
                  <span class="capitalize bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded-full text-xs font-medium">
                    {post.data.lang === 'th' ? 'ไทย' : 'English'}
                  </span>
                  <span>·</span>
                  <span>{post.data.date.toLocaleDateString('th-TH', { month: 'short', day: 'numeric' })}</span>
                </div>
              </div>
            </a>
          ))}
        </div>
      </div>
    </div>

    <!-- Programming Languages Section -->
    <div>
      <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 px-4">Languages</h3>
      <div class="bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-sm">
        <div class="divide-y divide-gray-200 dark:divide-gray-800">
          <a href="/languages/javascript" class="flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-yellow-400 rounded-lg flex items-center justify-center">
                <span class="text-black font-bold text-sm">JS</span>
              </div>
              <div>
                <div class="font-medium text-gray-900 dark:text-white">JavaScript</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">Web development</div>
              </div>
            </div>
          </a>
          
          <a href="/languages/python" class="flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center">
                <span class="text-white font-bold text-sm">PY</span>
              </div>
              <div>
                <div class="font-medium text-gray-900 dark:text-white">Python</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">Data & AI</div>
              </div>
            </div>
          </a>

          <a href="/languages/typescript" class="flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                <span class="text-white font-bold text-sm">TS</span>
              </div>
              <div>
                <div class="font-medium text-gray-900 dark:text-white">TypeScript</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">Type safety</div>
              </div>
            </div>
          </a>

          <a href="/languages/rust" class="flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-orange-600 rounded-lg flex items-center justify-center">
                <span class="text-white font-bold text-sm">RS</span>
              </div>
              <div>
                <div class="font-medium text-gray-900 dark:text-white">Rust</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">Systems</div>
              </div>
            </div>
          </a>

          <a href="/languages/go" class="flex items-center justify-between p-4 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-cyan-500 rounded-lg flex items-center justify-center">
                <span class="text-white font-bold text-sm">GO</span>
              </div>
              <div>
                <div class="font-medium text-gray-900 dark:text-white">Go</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">Backend</div>
              </div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
</aside>